<mat-toolbar class="ts-legend-toolbar">
    <mat-toolbar-row class="detail-brief">
        <span>Total Series: showing {{tableDataSource.data.length}} of {{data.series.length}}</span>
        <span class="flex-spacer"></span>
        <span>Sort by value {{(sort && sort.direction === 'asc') ? 'ascending' : 'descending'}}</span>
    </mat-toolbar-row>
</mat-toolbar>

<div class="ts-data-wrapper has-scroller">
    <div class="is-scroller" >
        <!--
            NOTE: Maybe build as normal table so we can use lazy loading
        -->
        <table #legendTable class="ts-legend-table"
            mat-table [dataSource]="tableDataSource"
            matSort matSortActive="value" matSortDirection="desc" matSortDisableClear="true" (matSortChange)="onMatSortChange($event)"
            (cdkObserveContent)="tableContentChanged($event)">

            <!-- Selection Column -->
            <ng-container matColumnDef="checkbox">
                <th mat-header-cell *matHeaderCellDef class="mat-elevation-z1">
                    <mat-checkbox value="" color="primary"></mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let element">
                    <mat-checkbox value="" color="primary"></mat-checkbox>
                </td>
            </ng-container>
        
            <!-- Metric Name Column -->
            <ng-container matColumnDef="metric">
                <th mat-header-cell *matHeaderCellDef class="mat-elevation-z1">metric</th>
                <td mat-cell *matCellDef="let element">
                    <span class="color-chip" [style.color]="element.series.color"></span>
                    <span>{{element.series.metric}}</span>
                </td>
            </ng-container>
        
            <!-- Tag Columns (dynamic) -->
            <ng-container *ngFor="let resultTag of resultTagKeys" [matColumnDef]="resultTag">
                <th mat-header-cell *matHeaderCellDef class="mat-elevation-z1">{{resultTag}}</th>
                <td mat-cell *matCellDef="let element">
                    <span>{{element.series.tags[resultTag]}}</span>
                </td>
            </ng-container>
        
            <!-- Value Column -->
            <ng-container matColumnDef="value">
                <th mat-header-cell *matHeaderCellDef mat-sort-header class="mat-elevation-z1"> Value </th>
                <td mat-cell *matCellDef="let element">
                    <span>{{element.formattedValue}}</span>
                </td>
            </ng-container>
        
            <tr mat-header-row *matHeaderRowDef="tableColumns; sticky: true" class="mat-elevation-z1"></tr>
            <tr mat-row *matRowDef="let row; columns: tableColumns;"></tr>
        </table>
    </div>
</div>

<!-- this gets injected into the island window header bar
     but context remains with this component -->
<info-island-toolbar customClass="timeseries-legend-toolbar">
    <div class="toolbar-item show-limit-types">
        <span>Show:</span>
        <button mat-flat-button [matMenuTriggerFor]="limitTypeMenu">
            <span>{{dataLimitType}}</span>
            <div class="mat-select-arrow-wrapper"><div class="mat-select-arrow"></div></div>
        </button>
        <mat-menu #limitTypeMenu="matMenu" class="show-limit-type-cdk-menu">
            <button mat-menu-item *ngFor="let type of dataLimitTypes;" (click)="dataLimitTypeChange(type)">{{type}}</button>
        </mat-menu>
    </div>
    <div class="toolbar-item show-amount-controls" *ngIf="dataLimitType !== 'All'">
        <input type="number" [formControl]="showAmount" max-length="3" autocomplete="off">
    </div>
    <div class="toolbar-item logscale-controls">
        <span>Logscale:</span>
        <mat-checkbox (change)="logscaleCheckboxChange('y1',$event.checked)" [checked]="logScaleY1">Y1</mat-checkbox>
        <mat-checkbox (change)="logscaleCheckboxChange('y2',$event.checked)" [checked]="logScaleY2">Y2</mat-checkbox>
    </div>
    <span class="flex-spacer" style="min-width: 30px;"></span>
    <div class="toolbar-item">
        <mat-checkbox (change)="trackmouseCheckboxChange($event)" [checked]="options.trackMouse" labelPosition="before">Track Mouse</mat-checkbox>
    </div>
</info-island-toolbar>
