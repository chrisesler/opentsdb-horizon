<mat-form-field class="contact-list" (click)="showMegaPanel()" floatLabel="never">
  <mat-chip-list #chipList>

    <mat-chip *ngFor="let id of selectedContacts" [selectable]="selectable"
      [removable]="contactRemovable" (removed)="removeContactFromSelectedContacts(id)">
      {{getRecipientFromId(id).name}}
    <mat-icon matChipRemove *ngIf="contactRemovable">cancel</mat-icon>
    </mat-chip>

    <input placeholder="Add contacts..."
            [matChipInputFor]="chipList"
            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            [matChipInputAddOnBlur]="addOnBlur"
            (matChipInputTokenEnd)="addUserInputToSelectedContacts($event)">
  </mat-chip-list>
</mat-form-field>

<div *ngIf="megaPanelVisible" class="mega-panel">

  <div class="panel-header">

      <div class="panel-title">
         <span *ngIf="viewMode === _mode.all">
            Select Recipients
         </span>
  
         <span *ngIf="viewMode === _mode.edit">
            Edit Recipients
         </span>
  
         <span *ngIf="viewMode === _mode.editRecipient">
            Edit {{recipient.type}} Recipient
         </span>
  
         <span *ngIf="viewMode === _mode.createRecipient">
            Create Recipient
         </span>
      </div>
  
      <div class="panel-actions" *ngIf="viewMode !== _mode.createRecipient">
  
        <div *ngIf="viewMode === _mode.all">
          <button (click)="setViewMode($event, _mode.createRecipient)"> Create </button>
          <button (click)="setViewMode($event, _mode.edit)"> Edit </button>
        </div>
  
        <div *ngIf="viewMode === _mode.edit">
          <button (click)="setViewMode($event, _mode.all)"> Done </button>
        </div>
  
        <div *ngIf="viewMode === _mode.editRecipient">
          <button (click)="deleteContact($event, recipient)"> Delete </button>
        </div>
      </div>
  
    </div>

  <div class="panel-content">
    <div *ngIf="viewMode === _mode.all || viewMode === _mode.edit" class="existing-contacts">

        <div class="contact-list-type" *ngFor="let type of types()">
            {{type}}
            <div class="contact-list-of-buttons">
              <span *ngIf="viewMode === _mode.all">
                  <button class="contact-button" *ngFor="let contact of getUnselectedRecipientsForType(type)" mat-button (click)="addRecipientToSelectedRecipients($event, contact.id)">+ {{contact.name}}</button>
              </span>

              <span *ngIf="viewMode === _mode.edit">
                  <button class="contact-button" *ngFor="let contact of getAllRecipientsForType(type)" mat-button (click)="editRecipientMode($event, contact.id)">x {{contact.name}}</button>
              </span>
            </div>
        </div>
    </div>

    <div *ngIf="viewMode === _mode.editRecipient || viewMode === _mode.createRecipient" class="change-recipient">

      <mat-radio-group *ngIf="viewMode === _mode.createRecipient" class="radio-group" [value]="recipientType">
          <mat-radio-button class="example-radio-button" *ngFor="let type of typesExceptEmail()" [value]="type" (change)="changeRecipientType($event.value)">
            {{type}}
          </mat-radio-button>
        </mat-radio-group>

        <div class="form">

          <div *ngIf="recipientType === _recipientType.OpsGenie" class="contacts-create-form">

            <!-- <form class="example-container" [formGroup]="recipient"> -->
              <div>
                <label>Team Name: </label>
                <mat-form-field floatLabel="never" appearance="fill">
                  <input matInput placeholder="Enter Team Name" required [value]="recipient.name" (input)="updateRecipient(recipient, 'name', $event.target.value)">
                </mat-form-field>
              </div>

              <div>
                <label>Priority: </label>
                <mat-radio-group [value]="recipient.priority" (change)="updateRecipient(recipient, 'priority', $event.value)">
                    <!-- formControlName="priority"  -->
                  <mat-radio-button value="P1">P1</mat-radio-button>
                  <mat-radio-button value="P2">P2</mat-radio-button>
                  <mat-radio-button value="P3">P3</mat-radio-button>
                  <mat-radio-button value="P4">P4</mat-radio-button>
                  <mat-radio-button value="P5">P5</mat-radio-button>
                </mat-radio-group>
              </div>
            <!-- </form> -->

          </div>

        </div>
    </div>

    <!-- <div *ngIf="panelContent === 'slack'">
        <div class="contacts-title">Create Slack Contact </div>
        <div class="contacts-create-form">
            <div class="labels">
                <div class="label">Channel name (#)</div>
                <div class="label">Webhook URL</div>
            </div>

            <div class="selectors">
                <div class="text-field selector">
                    <input #name matInput (keyup)="latestContactName(name.value)">
                </div>
                <div class="text-field selector">
                    <input matInput>
                </div>
            </div>
        </div>
        <button mat-button (click)="addContact('Slack')">Create</button>
        <button mat-button (click)="setPanelContent('existingContacts')">cancel</button>
    </div>

    <div *ngIf="panelContent === 'email'">
        <div class="contacts-title">Create Email </div>
        <div class="contacts-create-form">
            <div class="labels">
                <div class="label">Email</div>
            </div>

            <div class="selectors">
                <div class="text-field selector">
                    <input #name matInput (keyup)="latestContactName(name.value)">
                </div>
            </div>
        </div>
        <button mat-button (click)="addContact('Email')">Create</button>
        <button mat-button (click)="setPanelContent('existingContacts')">cancel</button>
    </div> -->

    <div class="panel-footer" *ngIf="viewMode === _mode.editRecipient || viewMode === _mode.createRecipient">
        <div *ngIf="viewMode === _mode.editRecipient">
          <button (click)="setViewMode($event, _mode.edit)"> Save </button>
          <button> Test </button>
          <button (click)="setViewMode($event, _mode.all)"> Cancel </button>
        </div>
  
        <div *ngIf="viewMode === _mode.createRecipient">
          <button (click)="saveCreatedRecipient($event)"> Save </button>
          <button> Test </button>
          <button (click)="setViewMode($event, _mode.all)"> Cancel </button>
        </div>
    </div>
  </div>
</div>